\documentclass[10pt]{IEEEtran} 
\usepackage{graphics}
\usepackage[cmex10]{amsmath}

\setlength{\topmargin}{0pt}
\setlength{\headheight}{0in}
\setlength{\headsep}{0in}
\setlength{\textheight}{9.0in}
\setlength{\footskip}{0.5in}
\setlength{\oddsidemargin}{0pt}
\setlength{\evensidemargin}{0pt}
\setlength{\textwidth}{6.5in}

\begin{document}
\title{Scheduling Simultaneous Events for Multiple Mobile Devices}
\author{Jacob Schwartz}
\maketitle

\begin{abstract}
MORE BS HERE.
When working with two mobile devices, one will act as the time source and the
other will then synchronize to it by calculating an offset. In this paper, a
basic network time synchronization technique will be used to schedule two mobile
devices to take a picture at the same time.
\end{abstract}

\section{Introduction}

Applications that communicate to other machines over the Internet occasionally
need to have their times synchronized to create a reference point that would be
used for the rest of their communications.  Mobile phone applications may not
want to use their local clock in various instances. For example, a user may
change their local clock in order to beat a loophole in a game. In this case,
the phone would be comparing what it believes the time to be with a server. This
technique of time synchronization is not restricted to a client and a cloud
server, it can also be performed between two mobile clients on the same network.
In this instance, one of the devices will have to act as the ``server'', and the
other device will calculate its offset based on the ``server'' device's time,
even if it not the correct time.

In this paper, we use a basic process to calculate the time offsets between two
mobile devices. We schedule an event on one of the devices and it tells the
other device to schedule the same event for the same time, using the time offset
of the device. To show the these events occur at the same point in time, both
device take a picture of the same clock. To take the experiment a step further,
the scheduling of events could also take place across different platforms or run
off different wireless protocols like TCP or Bluetooth.

% Paragraph talking about time syhcnornization NTP?:

To calculate the offset, a formula similar to the one used in NTP will be used.
This involves taking the time three on three occasions. The client devices
checks its time when it sends the request packet to the service device. This
time will be called $t_0$. When the server receives the request packet, it
immediately send the client the time on the server's clock($t_1$). The last
time($t_2$) is recorded by the client when it receives $t_1$ from the server. 
It is assumed that the round trip time is symmetric. The offset($o$) is the
server time minus the client time minus the half of the round trip time:
\begin{equation}
    o = t_1 - t_2 - \frac{t_2 - t_0}{2} 
\end{equation}

\section{Results}

To test the validity of our algorithm, we wrote a simple application to find 
the offset between two mobile devices, iOS devices in this case. This
application has one device declare itself the server. This device then waits for
a client device to connect. Over a UDP connection, the server then sends the
device's time in milliseconds since the Unix Epoch several times, which the
client uses to get an average offset from its time. Once this offset is
calculated, the user tells the client device when to take a picture. The client
tells the server to take a picture at the same point in time, using the average
offset that was calculated. To determine how far off the picture event take
place, the phones are positioned to take a picture of a digital clock.

%SCREEN SHOTS OF PICTURES AND SHIT

% \begin{figure}
% {\resizebox{3.2in}{!}{\includegraphics{experiment/out-0.png}}}
% \caption{Download times at 0 Kbps}
% \label{fig:graph0}
% \end{figure}

\section{Conclusion}

*These times were obtained on a laptop using a wireless network with little to 
no other traffic at the same time. Based on the times, it is clear that in this
setting there would be no need for downshifting. As seen in the Figures 1-5,
most of the times occur in under a second. Interestingly, the times for all of 
the Akumai segments with bandwidths that actually contain video download faster 
than the Azuki segments. This could happen for a number of reasons, closer 
physical location being one of them, but this is not the focus of the 
experiment.

This experiment was run between two iPhone 5 running iOS 7. MORE.

There are several expansions to this project. One next step is to port the 
application to other mobile operating systems to find any other potential 
pitfalls that would cause the offset and the timing to be incorrect. Connecting
over Bluetooth would eliminate the 'ugliness' of having to enter an IP address
to connect. To use more than two devices, a multicast protocol could be used and
one of the mobile devices would act as a server or an actual dedicated server
could be used. The latter would also remove the need to enter an IP address,
because it would be static. 

\begin{thebibliography}{1}

\bibitem{rate}
% C. Lui, I. Bouazizi, and M. Gabbouj, ``\emph{Rate Adaptation for Adaptive HTTP
% Streamimg},'' ACM MMSys'11, February 2011.

% \bibitem{cos}
% K. Ma, and R. Bartos, ``\emph{CoS Enforcement for HTTP Adaptive Streaming},'' 
% IEEE GC'12 Workshop, July 2003.

\end{thebibliography}

\end{document}
